<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <link rel="icon" href="/favicon.ico" />
    <title>%VITE_APP_TITLE%</title>
    <!--[if lt IE 11
      ]><script>
        window.location.href = '/html/ie.html';
      </script><!
    [endif]-->
    <style>
      html,
      body,
      #app {
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #loader-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 999999;
        background: transparent;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* 方案1: 旋转的圆环 */
      #loader-ring {
        display: inline-block;
        width: 50px;
        height: 50px;
      }

      #loader-ring:after {
        content: " ";
        display: block;
        width: 40px;
        height: 40px;
        margin: 4px;
        border-radius: 50%;
        border: 4px solid #0256ff;
        border-color: #0256ff transparent #0256ff transparent;
        animation: loader-ring 1.2s linear infinite;
      }

      @keyframes loader-ring {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* 方案2: 跳动的球 */
      #loader-bounce {
        width: 50px;
        height: 50px;
        position: relative;
      }

      .bounce-dot {
        width: 15px;
        height: 15px;
        background-color: #0256ff;
        border-radius: 50%;
        position: absolute;
        animation: bounce 1.5s infinite ease-in-out;
      }

      .bounce1 {
        left: 0;
        animation-delay: -0.32s;
      }

      .bounce2 {
        left: 20px;
        animation-delay: -0.16s;
      }

      .bounce3 {
        left: 40px;
      }

      @keyframes bounce {
        0%, 80%, 100% {
          transform: scale(0);
        }
        40% {
          transform: scale(1.0);
        }
      }

      /* 方案3: 旋转的方块 */
      #loader-cube {
        width: 40px;
        height: 40px;
        position: relative;
        transform: rotateZ(45deg);
      }

      #loader-cube .cube {
        float: left;
        width: 50%;
        height: 50%;
        position: relative;
        transform: scale(1.1);
      }

      #loader-cube .cube:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #0256ff;
        animation: cube-fold 2.4s infinite linear both;
        transform-origin: 100% 100%;
      }

      #loader-cube .cube2 {
        transform: scale(1.1) rotateZ(90deg);
      }

      #loader-cube .cube3 {
        transform: scale(1.1) rotateZ(180deg);
      }

      #loader-cube .cube4 {
        transform: scale(1.1) rotateZ(270deg);
      }

      #loader-cube .cube2:before {
        animation-delay: 0.3s;
      }

      #loader-cube .cube3:before {
        animation-delay: 0.6s;
      }

      #loader-cube .cube4:before {
        animation-delay: 0.9s;
      }

      @keyframes cube-fold {
        0%, 10% {
          transform: perspective(140px) rotateX(-180deg);
          opacity: 0;
        }
        25%, 75% {
          transform: perspective(140px) rotateX(0deg);
          opacity: 1;
        }
        90%, 100% {
          transform: perspective(140px) rotateY(180deg);
          opacity: 0;
        }
      }

      /* 方案4: 波浪效果 */
      #loader-wave {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 60px;
        height: 40px;
      }

      .wave-bar {
        background-color: #0256ff;
        height: 30px;
        width: 6px;
        margin: 0 2px;
        border-radius: 4px;
        animation: wave 1.2s ease-in-out infinite;
      }

      .wave-bar1 {
        animation-delay: -1.2s;
      }

      .wave-bar2 {
        animation-delay: -1.1s;
      }

      .wave-bar3 {
        animation-delay: -1s;
      }

      .wave-bar4 {
        animation-delay: -0.9s;
      }

      .wave-bar5 {
        animation-delay: -0.8s;
      }

      @keyframes wave {
        0%, 40%, 100% {
          transform: scaleY(0.4);
        }
        20% {
          transform: scaleY(1);
        }
      }

      .loaded #loader-ring,
      .loaded #loader-bounce,
      .loaded #loader-cube,
      .loaded #loader-wave {
        opacity: 0;
        transition: all 0.3s ease-out;
      }

      .loaded #loader-wrapper {
        visibility: hidden;
        transform: translateY(-100%);
        transition: all 0.3s 1s ease-out;
      }

      .no-js #loader-wrapper {
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="app">
      <div id="loader-wrapper">
        <!-- 默认使用旋转圆环效果，您可以根据喜好选择其他效果 -->
        <div id="loader-ring"></div>

        <!-- 其他效果可选（请注释掉上面的loader-ring并取消注释下面的任一个） -->
        <!--
        <div id="loader-bounce">
          <div class="bounce-dot bounce1"></div>
          <div class="bounce-dot bounce2"></div>
          <div class="bounce-dot bounce3"></div>
        </div>
        -->

        <!--
        <div id="loader-cube">
          <div class="cube cube1"></div>
          <div class="cube cube2"></div>
          <div class="cube cube4"></div>
          <div class="cube cube3"></div>
        </div>
        -->

        <!--
        <div id="loader-wave">
          <div class="wave-bar wave-bar1"></div>
          <div class="wave-bar wave-bar2"></div>
          <div class="wave-bar wave-bar3"></div>
          <div class="wave-bar wave-bar4"></div>
          <div class="wave-bar wave-bar5"></div>
        </div>
        -->
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>

    <!-- 添加脚本以动态设置主题色 -->
    <script>
      // 定义十六进制转RGB的函数
      function hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
          r: parseInt(result[1], 16),
          g: parseInt(result[2], 16),
          b: parseInt(result[3], 16)
        } : null;
      }

      // 更新所有loader元素颜色的函数
      function updateLoaderColors() {
        // 获取CSS变量中的主题色
        const rootStyles = getComputedStyle(document.documentElement);
        let primaryColor = rootStyles.getPropertyValue('--el-color-primary').trim();

        // 如果没有获取到CSS变量，则使用默认颜色
        if (!primaryColor) {
          primaryColor = '#0256ff';
        }

        // 更新所有可能的loader元素颜色
        const loaders = [
          document.getElementById('loader-ring'),
          document.getElementById('loader-bounce'),
          document.getElementById('loader-cube'),
          document.getElementById('loader-wave')
        ];

        loaders.forEach(loader => {
          if (!loader) return;

          // 根据不同的loader类型设置颜色
          if (loader.id === 'loader-ring') {
            const afterElement = loader.querySelector(':after');
            if (afterElement) {
              afterElement.style.borderColor = `${primaryColor} transparent ${primaryColor} transparent`;
            }
          } else if (loader.id === 'loader-bounce') {
            const dots = loader.querySelectorAll('.bounce-dot');
            dots.forEach(dot => {
              dot.style.backgroundColor = primaryColor;
            });
          } else if (loader.id === 'loader-cube') {
            const cubes = loader.querySelectorAll('.cube:before');
            cubes.forEach(cube => {
              cube.style.backgroundColor = primaryColor;
            });
          } else if (loader.id === 'loader-wave') {
            const bars = loader.querySelectorAll('.wave-bar');
            bars.forEach(bar => {
              bar.style.backgroundColor = primaryColor;
            });
          }
        });
      }

      // 页面加载完成后执行
      window.addEventListener('load', function() {
        // 延迟执行以确保CSS变量已加载
        setTimeout(updateLoaderColors, 100);
      });

      // 监听主题变化（如果应用中有切换主题的功能）
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
            // 延迟执行以确保CSS变量已更新
            setTimeout(updateLoaderColors, 50);
          }
        });
      });

      // 开始观察document元素的属性变化
      observer.observe(document.documentElement, {
        attributes: true // 观察属性变化
      });
    </script>
  </body>
</html>
